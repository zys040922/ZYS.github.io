<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>学习计划打卡（2026.1.1-3.1）</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            math: '#3B82F6',       // 数学 - 蓝色
            english: '#10B981',    // 英语 - 绿色
            politics: '#F59E0B',   // 政治/时政 - 橙色
            computer: '#8B5CF6'    // 计算机 - 紫色
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .task-completed {
        text-decoration: line-through;
        color: #94A3B8;
      }
      .current-date {
        background-color: #EFF6FF;
      }
      .current-date-highlight {
        animation: highlight 1.5s ease-in-out;
      }
      .subject-header {
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .sticky-header {
        position: sticky;
        top: 0;
        z-index: 100;
        background-color: #F9FAFB;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      }
      .sticky-first-col {
        position: sticky;
        left: 0;
        z-index: 50;
        background-color: #F9FAFB;
      }
      .sticky-first-col-body {
        position: sticky;
        left: 0;
        z-index: 40;
        background-color: white;
      }
      @keyframes highlight {
        0% { background-color: #EFF6FF; }
        50% { background-color: #DBEAFE; }
        100% { background-color: #EFF6FF; }
      }
    }
  </style>
</head>
<body class="bg-gray-50 font-sans">
  <div class="container mx-auto px-4 py-8 max-w-7xl">
    <div class="mb-4 flex justify-center">
      <button id="today-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg transition flex items-center gap-2 shadow-md">
        <i class="fa fa-calendar-o"></i> 查看今日任务
      </button>
    </div>
    
    <header class="mb-8 text-center">
      <h1 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-gray-800 mb-2">学习计划打卡表（2026.1.1-3.1）</h1>
      <p class="text-gray-600" id="current-date-display"></p>
      <div id="today-task-indicator" class="mt-2 px-4 py-2 rounded-md inline-block hidden"></div>
      <div class="flex flex-wrap justify-center gap-4 mt-4">
        <div class="flex items-center gap-2">
          <div class="w-4 h-4 bg-math rounded-full"></div>
          <span class="text-sm text-gray-600">数学任务</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-4 h-4 bg-english rounded-full"></div>
          <span class="text-sm text-gray-600">英语任务</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-4 h-4 bg-politics rounded-full"></div>
          <span class="text-sm text-gray-600">政治/时政任务</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-4 h-4 bg-computer rounded-full"></div>
          <span class="text-sm text-gray-600">计算机任务</span>
        </div>
      </div>
    </header>

    <div class="overflow-x-auto bg-white rounded-lg shadow-md" style="max-height: calc(70vh - 10px);">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50 sticky-header">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky-first-col">日期</th>
            <th class="px-6 py-3 text-left text-xs font-medium bg-math/10 text-math uppercase tracking-wider subject-header">数学</th>
            <th class="px-6 py-3 text-left text-xs font-medium bg-politics/10 text-politics uppercase tracking-wider subject-header">政治</th>
            <th class="px-6 py-3 text-left text-xs font-medium bg-english/10 text-english uppercase tracking-wider subject-header">英语单词</th>
            <th class="px-6 py-3 text-left text-xs font-medium bg-english/10 text-english uppercase tracking-wider subject-header">英语</th>
            <th class="px-6 py-3 text-left text-xs font-medium bg-computer/10 text-computer uppercase tracking-wider subject-header">计算机</th>
            <th class="px-6 py-3 text-left text-xs font-medium bg-politics/10 text-politics uppercase tracking-wider subject-header">时政</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200" id="task-body">
          <!-- 任务内容将通过JS动态生成 -->
        </tbody>
      </table>
    </div>

    <div class="mt-6 flex flex-col md:flex-row justify-between items-center gap-4">
      <div class="text-gray-600">
        <span id="completed-count">已完成: 0</span> / <span id="total-count">总任务: 0</span>
      </div>
    </div>
  </div>

  <script>
    // 生成日期范围（2026-01-01 至 2026-03-01）
    function generateDateRange(startDateStr, endDateStr) {
      const dates = [];
      const startDate = new Date(startDateStr);
      const endDate = new Date(endDateStr);
      let currentDate = new Date(startDate);
      while (currentDate <= endDate) {
        dates.push(currentDate.toISOString().split('T')[0]);
        currentDate.setDate(currentDate.getDate() + 1);
      }
      return dates;
    }
    const planDates = generateDateRange('2026-01-01', '2026-03-20');

    // 初始化学习计划
    let studyPlan = planDates.map(date => ({
      日期: date,
      数学: null,
      政治: null,
      英语单词: null,
      英语: null,
      计算机: null,
      时政: null
    }));

    // 1. 填充数学任务（1.2开始）
    const mathChapters = ["第一章", "第二章上", "第二章下", "第三章", "第四章上", "第四章下", "第五章", "第六章", "第七章", "第八章", "第九章上", "第九章下", "第十章上", "第十章下"];
    // 章节任务：1.2-1.15（共14天）
    mathChapters.forEach((chapter, idx) => {
      const dateIdx = 1 + idx; // 索引1对应1.2
      if (studyPlan[dateIdx]) studyPlan[dateIdx].数学 = chapter;
    });
    // 试卷任务：1.16开始，共43套
    for (let i = 0; i < 43; i++) {
      const dateIdx = 15 + i; // 索引15对应1.16
      if (studyPlan[dateIdx]) studyPlan[dateIdx].数学 = `数学试卷${i+1}套`;
    }

    // 2. 填充政治任务（1.2开始）
    const politicsChapters = [
      "习概导论", "习概第一章", "习概第二章", "习概第三章", "习概第四章", "习概第五章", "习概第六章", "习概第七章", "习概第八章", "习概第九章", "习概第十章", "习概第十一章", "习概第十二章", "习概第十三章", "习概第十四章", "习概第十五章", "习概第十六章", "习概第十七章",
      "毛概导论", "毛概第一章", "毛概第二章", "毛概第三章", "毛概第四章", "毛概第五章", "毛概第六章", "毛概第七章", "毛概第八章"
    ];
    // 章节任务：1.2-1.28（共27天，完成所有章节）
    politicsChapters.forEach((chapter, idx) => {
      const dateIdx = 1 + idx; // 索引1对应1.2，索引27对应1.28
      if (studyPlan[dateIdx]) studyPlan[dateIdx].政治 = chapter;
    });
    // 试卷任务：1.29开始，共27套
    for (let i = 0; i < 27; i++) {
      const dateIdx = 28 + i; // 索引28对应1.29
      if (studyPlan[dateIdx]) studyPlan[dateIdx].政治 = `政治试卷${i+1}套`;
    }

    // 3. 填充英语任务（1.2开始，共41套）
    let count=0;
    for (let i = 0; i < 60; i+=2) {
    	count++;
      const dateIdx = 1 + i; // 索引1对应1.2
      if (studyPlan[dateIdx]) studyPlan[dateIdx].英语 = `英语试卷${count}套`;
    }
    for (let i = 60; i < 71; i++) {
    	count++;
      const dateIdx = 1 + i; // 索引1对应1.2
      if (studyPlan[dateIdx]) studyPlan[dateIdx].英语 = `英语试卷${count}套`;
    }

    // 4. 填充英语单词（每天80个）
    studyPlan.forEach(item => item.英语单词 = "单词80个");

    // 5. 填充计算机任务（1.8开始，共35套）
    for (let i = 0; i < 35; i++) {
      const dateIdx = 7 + i; // 索引7对应1.8
      if (studyPlan[dateIdx]) studyPlan[dateIdx].计算机 = `计算机试卷${i+1}套`;
    }

    // 6. 填充时政：1月国内→1月国际→2月国内→2月国际...12月国内→12月国际循环
    const timeTopics = [];
    // 生成1-12月的国内+国际基础列表
    for (let month = 1; month <= 12; month++) {
      timeTopics.push(`${month}月国内`);
      timeTopics.push(`${month}月国际`);
    }
    // 按计划日期循环分配时政内容
    studyPlan.forEach((item, idx) => {
      const topicIdx = idx % timeTopics.length; // 取模实现循环
      item.时政 = timeTopics[topicIdx];
    });

    // 任务列定义
    const taskColumns = [
      { key: '日期', isTask: false, subject: null },
      { key: '数学', isTask: true, endDate: '2026-03-20', subject: 'math' },
      { key: '政治', isTask: true, endDate: '2026-03-20', subject: 'politics' },
      { key: '英语单词', isTask: true, endDate: '2026-03-20', subject: 'english' },
      { key: '英语', isTask: true, endDate: '2026-03-20', subject: 'english' },
      { key: '计算机', isTask: true, endDate: '2026-03-20', subject: 'computer' },
      { key: '时政', isTask: true, endDate: '2026-03-20', subject: 'politics' }
    ];

    // DOM元素
    const taskBody = document.getElementById('task-body');
    const currentDateDisplay = document.getElementById('current-date-display');
    const todayTaskIndicator = document.getElementById('today-task-indicator');
    const completedCountEl = document.getElementById('completed-count');
    const totalCountEl = document.getElementById('total-count');
    const todayBtn = document.getElementById('today-btn');

    // 获取当前日期（YYYY-MM-DD）
    const getCurrentDate = () => {
      const date = new Date();
      return date.toISOString().split('T')[0];
    };

    // 获取当前日期的任务
    const getTodayTasks = () => {
      const today = getCurrentDate();
      return studyPlan.find(plan => plan.日期 === today) || null;
    };

    // 初始化页面
    function init() {
      const now = new Date();
      currentDateDisplay.textContent = `今天是: ${now.toLocaleDateString('zh-CN', {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        weekday: 'long'
      })}`;

      renderTaskTable();
      showTodayTaskStatus();
      loadCheckStatus();
      updateTaskStats();
      todayBtn.addEventListener('click', scrollToToday);
    }

    // 显示今日任务状态
    function showTodayTaskStatus() {
      const todayTask = getTodayTasks();
      const today = getCurrentDate();
      const dateInPlan = studyPlan.some(plan => plan.日期 === today);
      
      if (dateInPlan) {
        todayTaskIndicator.classList.remove('hidden');
        const todayCheckboxes = document.querySelectorAll(`input[data-date="${today}"]`);
        const totalTodayTasks = todayCheckboxes.length;
        const completedTodayTasks = Array.from(todayCheckboxes).filter(cb => cb.checked).length;
        
        if (totalTodayTasks > 0) {
          const completionRate = Math.round((completedTodayTasks / totalTodayTasks) * 100);
          if (completionRate === 100) {
            todayTaskIndicator.className = 'mt-2 px-4 py-2 rounded-md inline-block bg-green-100 text-green-800';
            todayTaskIndicator.textContent = `今日任务已全部完成！`;
          } else {
            todayTaskIndicator.className = 'mt-2 px-4 py-2 rounded-md inline-block bg-blue-100 text-blue-800';
            todayTaskIndicator.textContent = `今日任务完成度: ${completedTodayTasks}/${totalTodayTasks} (${completionRate}%)`;
          }
        } else {
          todayTaskIndicator.className = 'mt-2 px-4 py-2 rounded-md inline-block bg-gray-100 text-gray-800';
          todayTaskIndicator.textContent = `今日无任务`;
        }
      } else {
        todayTaskIndicator.className = 'mt-2 px-4 py-2 rounded-md inline-block bg-red-100 text-red-800';
        todayTaskIndicator.textContent = `当前日期不在计划范围内`;
      }
    }

    // 渲染任务表格
    function renderTaskTable() {
      taskBody.innerHTML = '';
      
      studyPlan.forEach(plan => {
        const row = document.createElement('tr');
        row.className = plan.日期 === getCurrentDate()? 'current-date' : '';
        row.dataset.date = plan.日期;
        
        taskColumns.forEach((col, index) => {
          const cell = document.createElement('td');
          if (index === 0) {
            cell.className = `px-6 py-4 whitespace-nowrap text-sm sticky-first-col-body font-medium`;
          } else {
            cell.className = `px-6 py-4 whitespace-nowrap text-sm ${col.subject? `bg-${col.subject}/5` : ''}`;
          }
          
          if (col.isTask) {
            const isActive = new Date(plan.日期) <= new Date(col.endDate);
            if (isActive && plan[col.key]!== null) {
              const checkboxContainer = document.createElement('div');
              checkboxContainer.className = 'flex items-center gap-2';
              
              const checkbox = document.createElement('input');
              checkbox.type = 'checkbox';
              checkbox.className = `h-4 w-4 rounded border-gray-300 focus:ring-${col.subject}`;
              checkbox.dataset.date = plan.日期;
              checkbox.dataset.task = col.key;
              
              checkbox.addEventListener('change', function() {
                const label = this.nextElementSibling;
                this.checked? label.classList.add('task-completed') : label.classList.remove('task-completed');
                saveCheckStatus(this.dataset.date, this.dataset.task, this.checked);
                updateTaskStats();
                showTodayTaskStatus();
              });
              
              const label = document.createElement('span');
              label.textContent = plan[col.key];
              
              checkboxContainer.appendChild(checkbox);
              checkboxContainer.appendChild(label);
              cell.appendChild(checkboxContainer);
            }
          } else {
            if (plan[col.key]!== null) cell.textContent = plan[col.key];
          }
          
          row.appendChild(cell);
        });
        
        taskBody.appendChild(row);
      });
    }

    // 本地存储打卡状态
    function saveCheckStatus(date, task, isChecked) {
      localStorage.setItem(`check_${date}_${task}`, isChecked);
    }

    function loadCheckStatus() {
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      checkboxes.forEach(checkbox => {
        const key = `check_${checkbox.dataset.date}_${checkbox.dataset.task}`;
        const isChecked = localStorage.getItem(key) === 'true';
        if (isChecked) {
          checkbox.checked = true;
          checkbox.nextElementSibling.classList.add('task-completed');
        }
      });
    }

    // 更新任务统计
    function updateTaskStats() {
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      const total = checkboxes.length;
      const completed = Array.from(checkboxes).filter(cb => cb.checked).length;
      completedCountEl.textContent = `已完成: ${completed}`;
      totalCountEl.textContent = `总任务: ${total}`;
    }

    // 滚动到今日任务
    function scrollToToday() {
      const today = getCurrentDate();
      const todayRow = document.querySelector(`tr[data-date="${today}"]`);
      if (todayRow) {
        todayRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
        todayRow.classList.add('current-date-highlight');
        setTimeout(() => todayRow.classList.remove('current-date-highlight'), 1500);
      } else {
        alert('当前日期不在学习计划范围内');
      }
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
